<div
  class="modal-container position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"
  style="background-color: rgba(0, 0, 0, 0.5); z-index: 1050"
>
  <div
    class="modal-content bg-white rounded shadow-lg"
    style="max-width: 90%; max-height: 90vh; width: 900px; overflow: hidden"
  >
    <!-- Cabecera con botón de cierre -->
    <div
      class="modal-header bg-primary text-white py-2 px-3 d-flex justify-content-between align-items-center"
    >
      <h5 class="mb-0">Detalle del Producto</h5>
      <button
        class="btn btn-close btn-close-white"
        (click)="closeEditDialog()"
      ></button>
    </div>

    <!-- Cuerpo con scroll -->
    <div
      class="modal-body p-0"
      style="overflow-y: auto; max-height: calc(90vh - 60px)"
    >
      <div class="container-fluid py-3">
        <div class="card border-0 shadow-none">
          <div class="row g-0">
            <!-- Imagen a la izquierda -->
            <div class="col-md-5">
              <div
                class="position-relative h-100 d-flex align-items-center justify-content-center bg-light"
              >
                <img
                  [src]="currentProducto.imagen"
                  class="img-fluid rounded-start object-fit-contain"
                  style="max-height: 400px; width: 100%"
                  alt="{{ currentProducto.nombreProducto }}"
                />
                <span
                  class="badge bg-danger position-absolute top-0 end-0 mt-2 me-2"
                  >{{ getEstadoProducto(currentProducto.fechaCreacion) }}</span
                >
              </div>
            </div>
            <!-- Contenido a la derecha -->
            <div class="col-md-7">
              <div class="card-body p-4">
                <h2 class="card-title fw-bold text-primary mb-3">
                  {{ currentProducto.nombreProducto }}
                </h2>

                <div class="badge bg-info text-white mb-3 py-2 px-3">
                  Categoría: {{ currentProducto.nombreCategoria }}
                </div>

                <div
                  class="d-flex justify-content-between align-items-center my-4"
                >
                  <h3 class="text-primary fw-bold mb-0">
                    ${{ currentProducto.precio }}
                  </h3>
                  <span class="badge bg-success py-2 px-3">{{
                    getDisponibilidadProducto(currentProducto.cantidadProducto)
                  }}</span>
                </div>

                <!-- Descripción con "ver más" -->
                <div class="bg-light p-3 rounded mb-4">
                  <h5 class="text-primary mb-2">Descripción:</h5>
                  <div class="position-relative">
                    <div
                      [ngClass]="{
                        'overflow-hidden': !mostrarDescripcionCompleta
                      }"
                      [style.maxHeight]="
                        mostrarDescripcionCompleta ? 'none' : '80px'
                      "
                    >
                      <p>{{ currentProducto.descripcion }}</p>
                    </div>
                    <div
                      *ngIf="descripcionEsLarga && !mostrarDescripcionCompleta"
                      class="position-absolute bottom-0 start-0 w-100"
                      style="
                        height: 30px;
                        background: linear-gradient(
                          to bottom,
                          rgba(241, 245, 249, 0),
                          rgba(241, 245, 249, 1)
                        );
                      "
                    ></div>
                  </div>
                  <div class="text-center mt-2" *ngIf="descripcionEsLarga">
                    <button
                      class="btn btn-sm btn-outline-primary"
                      (click)="toggleDescripcion()"
                    >
                      {{ mostrarDescripcionCompleta ? "Ver menos" : "Ver más" }}
                      <i
                        class="bi"
                        [ngClass]="{
                          'bi-chevron-down': !mostrarDescripcionCompleta,
                          'bi-chevron-up': mostrarDescripcionCompleta
                        }"
                      ></i>
                    </button>
                  </div>
                </div>

                <div class="d-flex align-items-center mb-4">
                  <i class="bi bi-box-seam text-primary me-2"></i>
                  <span
                    >Cantidad disponible:
                    <strong>{{ currentProducto.cantidadProducto }}</strong>
                  </span>
                </div>

                <div class="d-flex align-items-center mb-4">
                  <i class="bi bi-calendar-date text-primary me-2"></i>
                  <span
                    >Fecha de creación:
                    <strong>{{
                      currentProducto.fechaCreacion | date : "dd/MM/yyyy"
                    }}</strong>
                  </span>
                </div>

                <form class="row mt-4">
                  <div class="col-md-6 mb-3">
                    <div class="input-group">
                      <span class="input-group-text bg-primary text-white"
                        >Cantidad</span
                      >
                      <input
                        type="number"
                        class="form-control"
                        min="1"
                        max="{{ currentProducto.cantidadProducto }}"
                        [(ngModel)]="cantidadProductoCompra"
                        name="cantidadCompra"
                      />
                    </div>
                  </div>
                </form>

                <div class="d-flex flex-wrap gap-2 mt-3">
                  <button
                    class="btn btn-primary btn-lg"
                    (click)="agregarAlCarrito()"
                  >
                    <i class="bi bi-cart-plus me-1"></i> Añadir al Carrito
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
